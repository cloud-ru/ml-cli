### Ð’Ð¾Ð¿Ñ€Ð¾ÑÑ‹ Ð¿Ð¾ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐµ



**Ð“Ð´Ðµ Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑÑ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»ÑŒ:**

1. Ð² ÐºÐ°Ñ‚Ð°Ð»Ð¾Ð³Ðµ ~/.mls


**ÐšÐ°Ðº Ð¿Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ÐµÑ‚ÑŒ ÑÐ¿Ð¸ÑÐ¾Ðº Ð¿Ñ€Ð¾Ñ„Ð¸Ð»ÐµÐ¹:**

1. Ð² ÐºÐ°Ñ‚Ð°Ð»Ð¾Ð³Ðµ ~/.mls (subl, vim, cat)
2. ```bash
   cat ~/.mls/credentials | grep -o '\[[^]]*\]'```
   
**ÐÐµ ÑƒÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÑ‚ÑÑ ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ:**

> ÐŸÐ°ÐºÐµÑ‚Ñ‹ Ð¸Ð· pypi https://pypi.org/simple Ð¸Ð¼ÐµÑŽÑ‚ Ð·Ð°Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¹ Ð¿Ð°ÐºÐµÑ‚ mls
   Ð—Ð°Ð´Ð°Ð²Ð°Ð¹Ñ‚Ðµ Ð²ÐµÑ€ÑÐ¸ÑŽ Ð¿Ð°ÐºÐµÑ‚Ð° Ð±ÑƒÐºÐ²Ð°Ð»ÑŒÐ½Ð¾ == 
```bash 
    pip install --index-url https://gitverse.ru/api/packages/cloudru/pypi/simple/ \
    --extra-index-url https://pypi.org/simple --trusted-host gitverse.ru mls==0.4.1
```



**Ð¥Ð¾Ñ‡Ñƒ Ð¸Ð¼ÐµÑ‚ÑŒ Ð¿Ñ€ÐµÐ´Ð·Ð°Ð¿Ð¾Ð»Ð½ÐµÐ½Ð½Ñ‹Ð¹ config.yaml Ð´Ð»Ñ Ð·Ð°Ð´Ð°Ñ‡:**

Ð”Ð»Ñ Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð° ÑÐ¿Ñ€Ð°Ð²Ð¾Ñ‡Ð½Ñ‹Ñ… Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ð¹ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÑŽÑ‚ Ð¼ÐµÑ‚Ð¾Ð´Ñ‹ 
> mls job types
>
> mls job yaml $TYPE
> 
> mls job clusters

Ð”Ð»Ñ Ñ‚Ð¾Ð³Ð¾ Ñ‡Ñ‚Ð¾ Ð±Ñ‹ ÑÐ³ÐµÐ½ÐµÑ€Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð¼Ð°Ð½Ð¸Ñ„ÐµÑÑ‚ Ð´Ð¾ÑÑ‚Ð°Ñ‚Ð¾Ñ‡Ð½Ð¾ Ð½Ð°Ð¿Ñ€Ð°Ð²Ð¸Ñ‚ÑŒ Ð²Ñ‹Ð²Ð¾Ð´ `mls job yaml $TYPE > $TYPE.yaml`
Ð­Ñ‚Ð¾Ñ‚ Ð¼ÐµÑ‚Ð¾Ð´ Ð²ÑÐµÐ³Ð´Ð° Ð¾Ð±Ñ…Ð¾Ð´Ð¸Ñ‚ ÐºÐ»Ð°ÑÑ Ð¸ Ð¾Ñ‚Ð´Ð°ÐµÑ‚ ÐµÐ³Ð¾ Ð½Ð°Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ðµ ÑÐ¾Ð³Ð»Ð°ÑÐ½Ð¾ Ð¸ÐµÑ€Ð°Ñ€Ñ…Ð¸Ð¸ - Ñ‚/Ðµ Ð¼Ð¾Ð¶Ð½Ð¾ Ð¿Ñ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Ð²ÑÐµÐ³Ð´Ð° yaml.

ÐÐ¸Ð¶Ðµ Ð¿Ñ€Ð¸Ð¼ÐµÑ€ Ð´Ð»Ñ Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ð¸ Ð¿Ñ€Ð¸Ð¼ÐµÑ€Ð¾Ð². 
```bash 
   #!/bin/bash

    # ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÐ¼ ÑÐ¿Ð¸ÑÐ¾Ðº Ñ‚Ð¸Ð¿Ð¾Ð² Ð¸Ð· ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹
    TYPES=$(mls job types)

    # Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ ÐºÐ°Ñ‚Ð°Ð»Ð¾Ð³Ð° samples, ÐµÑÐ»Ð¸ Ð¾Ð½ Ð½Ðµ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÐµÑ‚
    mkdir -p samples

    # ÐŸÑ€Ð¾Ñ…Ð¾Ð´Ð¸Ð¼ÑÑ Ð¿Ð¾ ÐºÐ°Ð¶Ð´Ð¾Ð¼Ñƒ Ð¸Ð· Ñ‚Ð¸Ð¿Ð¾Ð² Ð·Ð°Ð´Ð°Ð½Ð¸Ð¹ Ð¸ Ð³ÐµÐ½ÐµÑ€Ð¸Ñ€ÑƒÐµÐ¼ ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÑƒÑŽÑ‰Ð¸Ð¹ Ñ„Ð°Ð¹Ð» YAML
    for TYPE in $TYPES; do
        YAML_FILE="./samples/template.$TYPE.yaml"
    
        echo "Ð¡Ð³ÐµÐ½ÐµÑ€Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¹ Ð½Ð°Ð±Ð¾Ñ€ Ð¿Ñ€Ð¸Ð¼ÐµÑ€Ð¾Ð² $YAML_FILE from $TYPE..."
    
        {
            echo "# ðŸ¤ ÐŸÑ€Ð¸Ð¼ÐµÑ€ Ð·Ð°Ð¿ÑƒÑÐºÐ° $TYPE... Ð·Ð°Ð´Ð°Ñ‡ Ñ‡ÐµÑ€ÐµÐ· â˜ï¸ðŸ‘”ðŸ”’ mls job submit --config ./$YAML_FILE"
            echo "# ðŸ“š health - ðŸš€ÐŸÐ¾Ð»Ð½Ð¾ÑÑ‚ÑŒÑŽ Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€..."
            echo "# ðŸ“š policy - ðŸš€ÐŸÐ¾Ð»Ð½Ð¾ÑÑ‚ÑŒÑŽ Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€..."
            echo "# ðŸ“š processes ÐµÑÐ»Ð¸ Ð½Ðµ Ð·Ð°Ð´Ð°Ð½ ÑƒÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÑ‚ÑÑ Ð² ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²Ð¸Ð¸ Ñ gpu"
            echo "# ðŸ“š ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ https://api.ai.cloud.ru/public/v2/redoc"
            echo "# ðŸ“š ÐžÐ±Ñ€Ð°Ð·: https://cloud.ru/docs/aicloud/mlspace/concepts/environments__basic-images-list__jobs.html"
            echo "# ðŸ“š max_retry Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€ Ð¿Ñ€Ð¸Ð¼ÐµÐ½Ð¸Ð¼Ñ‹Ð¹ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ðº Ð°Ð»Ð»Ð¾ÐºÐ°Ñ†Ð¸ÑÐ¼"
        } > $YAML_FILE
    
        # Ð“ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ð¼Ð¾Ð³Ð¾ yaml Ñ‡ÐµÑ€ÐµÐ· mls job yaml
        mls job yaml $TYPE >> $YAML_FILE
    done
    echo "Ð’ÑÐµ Ð¿Ñ€Ð¸Ð¼ÐµÑ€Ñ‹ ÑÐ³ÐµÐ½ÐµÑ€Ð¸Ñ€Ð¾Ð²Ð°Ð½Ñ‹ Ð² ÐºÐ°Ñ‚Ð°Ð»Ð¾Ð³Ðµ samples."
```

**Ð Ð°Ð±Ð¾Ñ‚Ð° Ñ pipe:**
   ÐŸÑ€Ð¸Ð¼ÐµÑ€ ```mls job status  lm-mpi-job-787e491e-b098-4b00-bf79-5841dfc1f910 | jq .job_name```
    ![ Ð—Ð°Ð¿ÑƒÑÐº ](static/FAQ1.png)
   ÐŸÐ¾ÑÑÐ½ÐµÐ½Ð¸Ñ jq Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ json Ð¾Ñ‚Ð²ÐµÑ‚Ð¾Ð¼. Ð”Ð»Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ pipe Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»Ð¸Ñ‚Ðµ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚ Ð² ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ð¼ Ð±ÑƒÐ´ÐµÑ‚ Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ñ‚ÑŒ cli Ð³Ð»Ð¾Ð±Ð°Ð»ÑŒÐ½Ð¾. 

**Ð¡Ð¾ÐºÑ€Ñ‹Ñ‚Ð¸Ðµ credentials :**
   * TODO

**ÐžÑ‚Ð»Ð°Ð´ÐºÐ° Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ:**
   ÐŸÑ€Ð¸Ð¼ÐµÑ€ ```mls job status  lm-mpi-job-787e491e-b098-4b00-bf79-5841dfc1f910 -D```
   ![ Ð—Ð°Ð¿ÑƒÑÐº ](static/FAQ2.png)
   ÐŸÐ¾Ð·Ð²Ð¾Ð»ÑÐµÑ‚ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ x-request-id Ð¸Ð»Ð¸ Ð¸Ð½ÑƒÑŽ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸ÑŽ Ð¾ Ñ…Ð¾Ð´Ðµ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ Ð¸ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ð¸ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ°
   ![ Ð—Ð°Ð¿ÑƒÑÐº ](static/FAQ3.png)


**ÐžÑ‚Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ðµ ÑÐ¿Ð¸ÑÐºÐ°:**
   ÐŸÑ€Ð¸Ð¼ÐµÑ€ ```mls job list --limit 3|jq -r '.jobs[] | [.uid, .job_name, .region] | @tsv' | column -t```
   ![ Ð—Ð°Ð¿ÑƒÑÐº ](static/FAQ4.png)

   ÐŸÑ€Ð¸Ð¼ÐµÑ€ Ñ watch. (ÐÑƒÐ¶Ð½Ð¾ Ð´Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ ~/.zshrc Ð¸Ð»Ð¸ ~/.bashrc).
   ```bash
      function wp() {
         watch -n 2 "echo 'UID\t\t\t\t\tJOB_NAME\t\t\t\t\tREGION'; mls job list --limit 3 --status Pending | jq -r '.jobs[] | [.uid, .job_name, .region] | @tsv' | column -t"
      }
   ```
   ![ Ð—Ð°Ð¿ÑƒÑÐº ](static/FAQ5.png)

**ÐŸÑ€Ð¾Ñ„Ð¸Ð»ÑŒ Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ:**
   Ð—Ð°Ð´Ð°Ð¹Ñ‚Ðµ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»ÑŒ Ð² ÑÐµÑÑÐ¸Ð¸ Ñ‚ÐµÑ€Ð¼Ð¸Ð½Ð°Ð»Ð°. Ð˜Ð»Ð¸ Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»Ð¸Ñ‚Ðµ Ð² ~/.zshrc Ð¸Ð»Ð¸ ~/.bashrc
   > export MLS_PROFILE_DEFAULT=

**Ð—Ð°Ð¿ÑƒÑÐº Ð·Ð°Ð´Ð°Ñ‡Ð¸ Ñ Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð¾Ð¼ Ð»Ð¾Ð³Ð¾Ð² Ð¾Ð´Ð½Ð¾Ð¹ ÑÑ‚Ñ€Ð¾ÐºÐ¾Ð¹:**
   > mls job logs $(mls job submit --config binary.yaml | jq -r '.job_name') -w > sample.log | tee sample.log
